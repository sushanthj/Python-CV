

<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  

  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

  <link rel="stylesheet" href="/assets/css/just-the-docs-default.css">

  

  
    <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script>
  
  <script type="text/javascript" src="/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Pandas Case Study | Python Notes</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Pandas Case Study" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Python Notes" />
<meta property="og:description" content="Python Notes" />
<link rel="canonical" href="/padas_case_study" />
<meta property="og:url" content="/padas_case_study" />
<meta property="og:site_name" content="Python Notes" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Pandas Case Study" />
<script type="application/ld+json">
{"@type":"WebPage","url":"/padas_case_study","headline":"Pandas Case Study","description":"Python Notes","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  

</head>

<body>
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol id="svg-link" viewBox="0 0 24 24">
      <title>Link</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
      </svg>
    </symbol>
    <symbol id="svg-search" viewBox="0 0 24 24">
      <title>Search</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
        <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
      </svg>
    </symbol>
    <symbol id="svg-menu" viewBox="0 0 24 24">
      <title>Menu</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
        <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </symbol>
    <symbol id="svg-arrow-right" viewBox="0 0 24 24">
      <title>Expand</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
        <polyline points="9 18 15 12 9 6"></polyline>
      </svg>
    </symbol>
    <symbol id="svg-doc" viewBox="0 0 24 24">
      <title>Document</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
        <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
      </svg>
    </symbol>
  </svg>

  <div class="side-bar">
    <div class="site-header">
      <a href="/" class="site-title lh-tight">
  Python Notes

</a>
      <a href="#" id="menu-button" class="site-button">
        <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg>
      </a>
    </div>
    <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav">
      
        <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="/intro/" class="nav-list-link">Intro</a></li><li class="nav-list-item"><a href="/Lists%20and%20Strings/" class="nav-list-link">Lists and Strings</a></li><li class="nav-list-item"><a href="/Dictionaries/" class="nav-list-link">Dictionaries</a></li><li class="nav-list-item"><a href="/Power%20of%20Introspection/" class="nav-list-link">Functions and Modules</a></li><li class="nav-list-item"><a href="/Objects/" class="nav-list-link">Objects</a></li><li class="nav-list-item"><a href="/Exceptions+File_Handlers/" class="nav-list-link">Exceptions and File Handling</a></li><li class="nav-list-item"><a href="/Regex/" class="nav-list-link">RegEx</a></li><li class="nav-list-item"><a href="/File_Ops_and_Parsing/" class="nav-list-link">File Ops and Parsing</a></li><li class="nav-list-item"><a href="/numpy/" class="nav-list-link">Numpy</a></li><li class="nav-list-item"><a href="/CV%20Concepts/" class="nav-list-link">CV Edge Detection and Filters</a></li><li class="nav-list-item"><a href="/OpenCV/" class="nav-list-link">OpenCV</a></li><li class="nav-list-item"><a href="/Multi-Proc,%20JSON,%20usr_inp/" class="nav-list-link">Multi-Processing, JSONS, and User-Inputs</a></li><li class="nav-list-item"><a href="/git_concepts" class="nav-list-link">Git Concepts</a></li><li class="nav-list-item active"><a href="/padas_case_study" class="nav-list-link active">Pandas Case Study</a></li></ul>

      
    </nav>
    <footer class="site-footer">
      This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.
    </footer>
  </div>
  <div class="main" id="top">
    <div id="main-header" class="main-header">
      
        <div class="search">
          <div class="search-input-wrap">
            <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Python Notes" aria-label="Search Python Notes" autocomplete="off">
            <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
          </div>
          <div id="search-results" class="search-results"></div>
        </div>
      
      
      
        <nav aria-label="Auxiliary" class="aux-nav">
          <ul class="aux-nav-list">
            
              <li class="aux-nav-list-item">
                <a href="//github.com/sushanthj" class="site-button"
                  
                >
                  Sushanth's GitHub
                </a>
              </li>
            
          </ul>
        </nav>
      
    </div>
    <div id="main-content-wrap" class="main-content-wrap">
      
        
      
      <div id="main-content" class="main-content" role="main">
        
          <details open="">
  <summary class="text-delta">
    Table of contents
  </summary>
<ol id="markdown-toc">
  <li><a href="#before-you-begin" id="markdown-toc-before-you-begin">Before you Begin</a></li>
  <li><a href="#problem-definition" id="markdown-toc-problem-definition">Problem definition</a></li>
  <li><a href="#solution-implementation" id="markdown-toc-solution-implementation">Solution Implementation</a>    <ol>
      <li><a href="#reading-from-a-text-file" id="markdown-toc-reading-from-a-text-file">Reading from a text file:</a></li>
    </ol>
  </li>
</ol>

</details>
      <h1 class="fs-9" id="before-you-begin">
        
        
          <a href="#before-you-begin" class="anchor-heading" aria-labelledby="before-you-begin"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Before you Begin
        
        
      </h1>
    

<p><a href="" class="btn fs-5 mb-4 mb-md-0">Reference</a></p>
      <h1 id="problem-definition">
        
        
          <a href="#problem-definition" class="anchor-heading" aria-labelledby="problem-definition"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Problem definition
        
        
      </h1>
    

<p>Few ROS nodes were profiled to measure the transfer delays between ROS nodes in series. I wrote the outputs from each node into a text file; indexing each entry with the camera_id of that particular image</p>

<p>Now I had multiple text files, with entries like:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>camID 9550 CD_in_time 1648216864996326208
camID 9551 CD_in_time 1648216865085628986
</code></pre></div></div>

<p>The above lines were for one node only (the input to one node). Now, to process such data from all nodes, I had to convert these rows into a <strong>pandas dataframe</strong></p>
      <h1 id="solution-implementation">
        
        
          <a href="#solution-implementation" class="anchor-heading" aria-labelledby="solution-implementation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Solution Implementation
        
        
      </h1>
    
      <h2 id="reading-from-a-text-file">
        
        
          <a href="#reading-from-a-text-file" class="anchor-heading" aria-labelledby="reading-from-a-text-file"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Reading from a text file:
        
        
      </h2>
    

<p>We will be reading from a folder and extracting all text files from there.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span><span class="p">,</span> <span class="n">deepcopy</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">index</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">glob</span>

<span class="kn">from</span> <span class="nn">scipy.misc</span> <span class="kn">import</span> <span class="n">electrocardiogram</span>

<span class="n">my_dir_path</span> <span class="o">=</span> <span class="s">"/home/sush/TS/e2e_test/eval_sj"</span>

<span class="n">collated_data</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="n">file_count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="nb">file</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="p">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">my_dir_path</span><span class="p">,</span> <span class="s">'*.txt'</span><span class="p">))):</span>
    <span class="n">file_count</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="s">"r"</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_open</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file_open</span><span class="p">:</span>
            <span class="c1"># add the contents of each line to a list
</span>            <span class="n">elements</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="n">split</span><span class="p">(</span><span class="s">'camID '</span><span class="p">)[</span><span class="mi">1</span><span class="p">].</span><span class="n">split</span><span class="p">(</span><span class="s">" "</span><span class="p">)</span>
            <span class="c1"># save data according to camID (which is the element[0] in each line)
</span>            <span class="n">collated_data</span><span class="p">[</span><span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">]].</span><span class="n">append</span><span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">collated_data</span><span class="p">[</span><span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">]].</span><span class="n">append</span><span class="p">((</span><span class="nb">float</span><span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="mi">1000</span><span class="p">))</span>
        
    <span class="c1"># Note. If the data for each index (here camID) does not match the lenght of data in other datapoints, 
</span>    <span class="c1"># pandas cannot create a dataframe
</span>    <span class="n">collated_data_clone</span> <span class="o">=</span> <span class="n">copy</span><span class="p">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">collated_data</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">cam_id</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">collated_data_clone</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># check if any entry (whose key is camID) is not recoreded in each node
</span>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">file_count</span> <span class="o">*</span> <span class="mi">2</span><span class="p">):</span>
            <span class="c1"># if data missing in any node: delete the data for that particular camID
</span>            <span class="k">del</span> <span class="n">collated_data</span><span class="p">[</span><span class="n">cam_id</span><span class="p">]</span>

<span class="n">dframe</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">collated_data</span><span class="p">)</span>
<span class="c1"># the above created df will have camID as columns, we want it to be row-wise therefore transpose
</span><span class="n">dframe</span> <span class="o">=</span> <span class="n">dframe</span><span class="p">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="c1"># sort the columns according to name
</span>
<span class="n">proc_time_column_no</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">handover_column_no</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">print</span><span class="p">(</span><span class="s">"text file count is"</span><span class="p">,</span> <span class="n">file_count</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">file_count</span><span class="o">/</span><span class="mi">2</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">file_count</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">proc_time_column_no</span> <span class="o">+=</span> <span class="mi">4</span>
        <span class="n">handover_column_no</span> <span class="o">+=</span> <span class="mi">4</span>
        <span class="n">dframe</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">proc_time_column_no</span><span class="p">,</span> <span class="s">'proc_time_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="bp">None</span><span class="p">)</span>
        <span class="n">dframe</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">handover_column_no</span><span class="p">,</span> <span class="s">'handover_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">proc_time_column_no</span> <span class="o">+=</span> <span class="mi">4</span>
        <span class="n">dframe</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">proc_time_column_no</span><span class="p">,</span> <span class="s">'proc_time_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="bp">None</span><span class="p">)</span>

<span class="c1">#print(dframe)
</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">file_count</span><span class="o">/</span><span class="mi">2</span><span class="p">)):</span>
    <span class="n">time_columns</span> <span class="o">=</span> <span class="p">[((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> 
    <span class="n">preproc_column_name</span> <span class="o">=</span> <span class="s">"proc_time_"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">dframe</span><span class="p">[</span><span class="n">preproc_column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">dframe</span><span class="p">[</span><span class="n">time_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">-</span> <span class="n">dframe</span><span class="p">[</span><span class="n">time_columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="c1">#print(dframe)
</span><span class="n">dframe</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">my_dir_path</span><span class="p">,</span> <span class="s">'evaluation.csv'</span><span class="p">))</span>
</code></pre></div></div>

        

        

        
        
          <hr>
          <footer>
            

            <p class="text-small text-grey-dk-100 mb-0"></p>

            
              <div class="d-flex mt-2">
                
                
              </div>
            
          </footer>
        

      </div>
    </div>

    
      

      <div class="search-overlay"></div>
    
  </div>
</body>
</html>

